import{_ as s,c as a,o as n,R as i}from"./chunks/framework.8gwMId7n.js";const p="/assets/npm.qifLs_FR.png",e="/assets/package-lock.BToC7ZXF.png",l="/assets/package-lock-cache.OnY3qE8I.png",t="/assets/package-lock-cache1.DVB_4N6e.png",E=JSON.parse('{"title":"包的安装机制","description":"","frontmatter":{},"headers":[],"relativePath":"node/npm.md","filePath":"node/npm.md","lastUpdated":1702286571000}'),h={name:"node/npm.md"},c=i('<h1 id="包的安装机制" tabindex="-1">包的安装机制 <a class="header-anchor" href="#包的安装机制" aria-label="Permalink to &quot;包的安装机制&quot;">​</a></h1><h2 id="npmrc文件" tabindex="-1">.npmrc文件 <a class="header-anchor" href="#npmrc文件" aria-label="Permalink to &quot;.npmrc文件&quot;">​</a></h2><p>用于配置npm行为的文件,允许自定义npm的各种配置，主要控制npm安装、发布、更新、和管理包的行为。例如：镜像源、代理、认证信息、依赖管理等。 .npmrc位置：用户主目录下，项目根目录下，分别会影响全局npm的行为和指定项目的npm行为操作。</p><h2 id="安装地址windows" tabindex="-1">安装地址Windows <a class="header-anchor" href="#安装地址windows" aria-label="Permalink to &quot;安装地址Windows&quot;">​</a></h2><p><img src="'+p+`" alt="test"></p><h2 id="npmrc文件配置" tabindex="-1">.npmrc文件配置 <a class="header-anchor" href="#npmrc文件配置" aria-label="Permalink to &quot;.npmrc文件配置&quot;">​</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-SRayP" id="tab-RONYAeT" checked="checked"><label for="tab-RONYAeT">npm</label></div><div class="blocks"><div class="language-sh vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 镜像源地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">registry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://registry.npmjs.org/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置代理服务器，用于加速指定包的下载。这在首先网络环境下工作有很大作用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://proxy.example.com/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 与proxy类似，但用于HTTPS请求的代理。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https-proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://proxy.example.com/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># prefix：定义全局安装包的目录。默认情况下，全局包将安装在</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\npm（Windows）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/local（linux）</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># userconfig：指定用户级别的配置文件路径，用于覆盖全局配置。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">userconfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/path/to/custom/user-config-file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cache：设置npm包的缓存目录，可以加快包的查找速度和减少下载次数。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/path/to/npm/cache</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># production：指示npm只安装生产依赖包。在部署生产环境时，这可确保不会安装开发依赖包。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">production</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># loglevel：设置npm的日志级别，以控制输出的详细程度。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loglevel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">warn</span></span></code></pre></div></div></div><h2 id="npm-install流程" tabindex="-1">npm install流程 <a class="header-anchor" href="#npm-install流程" aria-label="Permalink to &quot;npm install流程&quot;">​</a></h2><h2 id="检查并获取-npm-配置" tabindex="-1">检查并获取 npm 配置 <a class="header-anchor" href="#检查并获取-npm-配置" aria-label="Permalink to &quot;检查并获取 npm 配置&quot;">​</a></h2><ul><li>项目级的 .npmrc 文件 &gt; 用户级的 .npmrc 文件&gt; 全局级的 .npmrc 文件 &gt; npm 内置的 .npmrc 文件</li></ul><h2 id="在package-lock-json查找包名" tabindex="-1">在package-lock.json查找包名 <a class="header-anchor" href="#在package-lock-json查找包名" aria-label="Permalink to &quot;在package-lock.json查找包名&quot;">​</a></h2><ul><li>若有：检查 package-lock.json 和 package.json 中声明的依赖是否一致：一致就直接使用package-lock.json 中的信息，从缓存或网络资源中加载依赖；不一致，则依据npm的版本进行处理</li><li>若无：则根据 package.json 递归构建依赖树，按照构建好的依赖树下载完整的依赖资源，在下载时就会检查是否存在相关资源缓存：存在缓存，就会将缓存内容解压到node_modules 中；不存在缓存，就从npm远程仓库下载包，并会检验包的完整性，随后添加到缓存，解压到node_modules 中生成package-lock.json</li></ul><h2 id="package-lock-json" tabindex="-1">package-lock.json <a class="header-anchor" href="#package-lock-json" aria-label="Permalink to &quot;package-lock.json&quot;">​</a></h2><p><img src="`+e+`" alt="alt text"></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>vesion:指定包的版本</span></span>
<span class="line"><span>resolved：指定包的下载地址</span></span>
<span class="line"><span>integrity：验证包的完整性</span></span>
<span class="line"><span>dev：是否是一个开发依赖包</span></span>
<span class="line"><span>bin：指定当前包中可执行的文件路径和名称</span></span>
<span class="line"><span>engines：指定当前包依赖的node版本号</span></span></code></pre></div><h2 id="package-lock-json作用" tabindex="-1">package-lock.json作用 <a class="header-anchor" href="#package-lock-json作用" aria-label="Permalink to &quot;package-lock.json作用&quot;">​</a></h2><p>提供缓存作用,默认会通过name+version+integrity信息生成唯一key,基于key寻找对应的index-v5的缓存记录 如果发现存在缓存，就会找到tar包的hash值，然后将对应的二进制文件解析到当前项目的node_modules <img src="`+l+'" alt="tesxt"><img src="'+t+'" alt="tesxt"></p>',17),o=[c];function k(r,d,g,m,u,y){return n(),a("div",null,o)}const b=s(h,[["render",k]]);export{E as __pageData,b as default};
